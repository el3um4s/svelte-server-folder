var app=function(){"use strict";function t(){}function n(t){return t()}function e(){return Object.create(null)}function o(t){t.forEach(n)}function r(t){return"function"==typeof t}function i(t,n){return t!=t?n==n:t!==n||t&&"object"==typeof t||"function"==typeof t}function a(t,n){t.appendChild(n)}function s(t){t.parentNode.removeChild(t)}function c(t){return document.createElement(t)}function l(t){return document.createTextNode(t)}function d(){return l(" ")}function u(t,n,e){null==e?t.removeAttribute(n):t.getAttribute(n)!==e&&t.setAttribute(n,e)}function f(t,n){n=""+n,t.wholeText!==n&&(t.data=n)}let g;function h(t){g=t}function p(t){(function(){if(!g)throw new Error("Function called outside component initialization");return g})().$$.on_mount.push(t)}const m=[],v=[],w=[],y=[],$=Promise.resolve();let x=!1;function k(t){w.push(t)}const b=new Set;let _=0;function C(){const t=g;do{for(;_<m.length;){const t=m[_];_++,h(t),E(t.$$)}for(h(null),m.length=0,_=0;v.length;)v.pop()();for(let t=0;t<w.length;t+=1){const n=w[t];b.has(n)||(b.add(n),n())}w.length=0}while(m.length);for(;y.length;)y.pop()();x=!1,b.clear(),h(t)}function E(t){if(null!==t.fragment){t.update(),o(t.before_update);const n=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,n),t.after_update.forEach(k)}}const j=new Set;function D(t,n){-1===t.$$.dirty[0]&&(m.push(t),x||(x=!0,$.then(C)),t.$$.dirty.fill(0)),t.$$.dirty[n/31|0]|=1<<n%31}function W(i,a,c,l,d,u,f,p=[-1]){const m=g;h(i);const v=i.$$={fragment:null,ctx:null,props:u,update:t,not_equal:d,bound:e(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(a.context||(m?m.$$.context:[])),callbacks:e(),dirty:p,skip_bound:!1,root:a.target||m.$$.root};f&&f(v.root);let w=!1;if(v.ctx=c?c(i,a.props||{},((t,n,...e)=>{const o=e.length?e[0]:n;return v.ctx&&d(v.ctx[t],v.ctx[t]=o)&&(!v.skip_bound&&v.bound[t]&&v.bound[t](o),w&&D(i,t)),n})):[],v.update(),w=!0,o(v.before_update),v.fragment=!!l&&l(v.ctx),a.target){if(a.hydrate){const t=function(t){return Array.from(t.childNodes)}(a.target);v.fragment&&v.fragment.l(t),t.forEach(s)}else v.fragment&&v.fragment.c();a.intro&&((y=i.$$.fragment)&&y.i&&(j.delete(y),y.i($))),function(t,e,i,a){const{fragment:s,on_mount:c,on_destroy:l,after_update:d}=t.$$;s&&s.m(e,i),a||k((()=>{const e=c.map(n).filter(r);l?l.push(...e):o(e),t.$$.on_mount=[]})),d.forEach(k)}(i,a.target,a.anchor,a.customElement),C()}var y,$;h(m)}const L=async()=>{console.log("Registering service worker...");try{const t=await navigator.serviceWorker.register("sw.js",{scope:"./"});console.info("Registered service worker on "+t.scope)}catch(t){console.warn("Failed to register service worker: ",t)}},M=async()=>{if(navigator.serviceWorker&&!navigator.serviceWorker.controller){const t=new Promise((t=>navigator.serviceWorker.addEventListener("controllerchange",t,{once:!0}))),n=function(t,n){let e=-1;const o=new Promise(((o,r)=>{e=self.setTimeout((()=>r(n)),t)}));return{promise:o,cancel:()=>self.clearTimeout(e)}}(4e3,"SW ready timeout");await Promise.race([t,n.promise]),n.cancel()}},B=t=>{navigator.serviceWorker.controller.postMessage(t)},F=async()=>{const t=await(async()=>await window.showDirectoryPicker())();return await M(),B({type:"host-start"}),t},z=async(t,n)=>{n&&!n.endsWith("/")&&(n+="/");let e=`\n<!DOCTYPE html>\n<html>\n${(t=>`<head>\n\t<meta charset="utf-8">\n\t<title>Directory listing for ${t||"/"}</title>\n</head>`)(n)}\n\n<body>\n  <main>\n  ${(t=>`<h1>Directory listing for ${t||"/"}</h1>`)(n)}\n\n  <div class="list">\n  ${(t=>"/"!=(t||"/")?'<div class="item go-up"><div class="icon">\n<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">\n  <path fill-rule="evenodd" d="M5.293 9.707a1 1 0 010-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 01-1.414 1.414L11 7.414V15a1 1 0 11-2 0V7.414L6.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd" />\n</svg></div><div class="link"><a href="../">../</a></div></div>':"")(n)}\n  ${await(async t=>{let n="";for await(const[e,o]of t.entries()){const t="directory"===o.kind?"/":"",r="index.html"===e.toLowerCase();n+=`<div class="item ${r?"index":""}"><div class="icon">${"directory"===o.kind?'\n<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">\n  <path d="M2 6a2 2 0 012-2h5l2 2h5a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" />\n</svg>':r?'\n<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">\n  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />\n</svg>':'\n<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">\n  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z" />\n</svg>'}</div><div class="link"><a href="${e}${t}">${e}${t}</a></div></div>`}return n})(t)}\n  </div>\n  </main>\n</body>\n\n\n<style>\n    body { \n        display: grid;\n        justify-content: center;\n        justify-items: start;\n        background-color: #DFCDC3;\n        color: #333242;\n        box-sizing: border-box;\n    }\n\n    main {\n        width: 60ch;\n        max-width: 60ch;\n    }\n\n    .list { \n        display: grid;\n        justify-content: start;\n        justify-items: start;\n        padding: 4px;\n        grid-row-gap: 8px;\n    }\n\n    .item { \n        display: grid;\n        align-items: center;\n        justify-items: start;\n        grid-template-columns: 32px auto;\n        padding: 4px;\n    }\n\n    .go-up {\n        margin-bottom: 16px;\n    }\n\n    a {\n        color: #333242;\n        text-decoration: none;\n    }\n\n    .index {\n        font-weight: 600;\n        border: 1px dotted #333242;\n        background-color: #DCB454;\n    }\n    a:hover, .item:hover {\n        background-color: #DCB454;\n        color: #1F6435;\n    }\n\n    .icon {\n        margin-right:4px;\n    }\n    svg {\n        width: 24px;\n        height: 24px;\n    }\n</style>\n\n\n</html>`;return new Blob([e],{type:"text/html"})};function N(n){let e,o,r,i,g,h,p,m,v,w,y,$,x,k,b,_,C,E,j,D,W,L=n[0]?.name+"";return{c(){e=c("main"),o=c("p"),o.textContent="Version: 0.0.4",r=d(),i=c("button"),i.textContent="Load Folder",g=d(),h=c("div"),p=l("folderName: "),m=l(L),v=d(),w=c("div"),y=l("clientID: "),$=l(n[3]),x=d(),k=c("div"),b=c("a"),_=l(n[2]),C=l(n[1]),E=l("/"),u(b,"href",j=n[2]+n[1]+"/"),u(b,"class","svelte-f579x2")},m(t,s){var c,l,d,u;!function(t,n,e){t.insertBefore(n,e||null)}(t,e,s),a(e,o),a(e,r),a(e,i),a(e,g),a(e,h),a(h,p),a(h,m),a(e,v),a(e,w),a(w,y),a(w,$),a(e,x),a(e,k),a(k,b),a(b,_),a(b,C),a(b,E),D||(c=i,l="click",d=n[4],c.addEventListener(l,d,u),W=()=>c.removeEventListener(l,d,u),D=!0)},p(t,[n]){1&n&&L!==(L=t[0]?.name+"")&&f(m,L),8&n&&f($,t[3]),4&n&&f(_,t[2]),2&n&&f(C,t[1]),6&n&&j!==(j=t[2]+t[1]+"/")&&u(b,"href",j)},i:t,o:t,d(t){t&&s(e),D=!1,W()}}}function P(t,n,e){let o=null,r="",i=null,a="";p((async()=>{await L()})),window.addEventListener("unload",(()=>{B({type:"host-stop",hostName:r})})),navigator.serviceWorker.addEventListener("message",(t=>{switch(t.data.type){case"start-ok":n=t.data,e(1,r=n.hostName),e(2,i=n.scope),e(3,a=n.clientId);break;case"fetch":(async(t,n)=>{try{let e=decodeURIComponent(n.data.url);e.endsWith("/")&&(e=e.substr(0,e.length-1));const o=e.indexOf("?");-1!==o&&(e=e.substr(0,o));const r=e.split("/");let i=t;for(let t=0,n=r.length-1;t<n;++t){const n=r[t];i=await i.getDirectoryHandle(n)}let a=null;const s=r[r.length-1];if(s)try{const t=await i.getDirectoryHandle(s);a=await z(t,e)}catch{const t=await i.getFileHandle(s);a=await t.getFile()}else a=await z(i,e);n.data.port.postMessage({type:"ok",file:a})}catch(t){console.error(`Unable to serve file '${n.data.url}': `,t),n.data.port.postMessage({type:"not-found"})}})(o,t);break;default:console.warn(`Unknown message from SW '${t.data.type}'`)}var n}));return[o,r,i,a,async()=>{e(0,o=await F())}]}const A=new class extends class{$destroy(){!function(t,n){const e=t.$$;null!==e.fragment&&(o(e.on_destroy),e.fragment&&e.fragment.d(n),e.on_destroy=e.fragment=null,e.ctx=[])}(this,1),this.$destroy=t}$on(t,n){const e=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return e.push(n),()=>{const t=e.indexOf(n);-1!==t&&e.splice(t,1)}}$set(t){var n;this.$$set&&(n=t,0!==Object.keys(n).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}{constructor(t){super(),W(this,t,P,N,i,{})}}({target:document.body});return A}();
//# sourceMappingURL=bundle.js.map
