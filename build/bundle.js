var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function r(t){return"function"==typeof t}function a(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(t,e){t.appendChild(e)}function i(t){t.parentNode.removeChild(t)}function s(t){return document.createElement(t)}function l(t){return document.createTextNode(t)}function u(){return l(" ")}function d(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function f(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}let h;function p(t){h=t}function g(t){(function(){if(!h)throw new Error("Function called outside component initialization");return h})().$$.on_mount.push(t)}const m=[],$=[],y=[],w=[],v=Promise.resolve();let b=!1;function k(t){y.push(t)}const x=new Set;let _=0;function E(){const t=h;do{for(;_<m.length;){const t=m[_];_++,p(t),W(t.$$)}for(p(null),m.length=0,_=0;$.length;)$.pop()();for(let t=0;t<y.length;t+=1){const e=y[t];x.has(e)||(x.add(e),e())}y.length=0}while(m.length);for(;w.length;)w.pop()();b=!1,x.clear(),p(t)}function W(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(k)}}const D=new Set;function C(t,e){-1===t.$$.dirty[0]&&(m.push(t),b||(b=!0,v.then(E)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function L(a,c,s,l,u,d,f,g=[-1]){const m=h;p(a);const $=a.$$={fragment:null,ctx:null,props:d,update:t,not_equal:u,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(c.context||(m?m.$$.context:[])),callbacks:n(),dirty:g,skip_bound:!1,root:c.target||m.$$.root};f&&f($.root);let y=!1;if($.ctx=s?s(a,c.props||{},((t,e,...n)=>{const o=n.length?n[0]:e;return $.ctx&&u($.ctx[t],$.ctx[t]=o)&&(!$.skip_bound&&$.bound[t]&&$.bound[t](o),y&&C(a,t)),e})):[],$.update(),y=!0,o($.before_update),$.fragment=!!l&&l($.ctx),c.target){if(c.hydrate){const t=function(t){return Array.from(t.childNodes)}(c.target);$.fragment&&$.fragment.l(t),t.forEach(i)}else $.fragment&&$.fragment.c();c.intro&&((w=a.$$.fragment)&&w.i&&(D.delete(w),w.i(v))),function(t,n,a,c){const{fragment:i,on_mount:s,on_destroy:l,after_update:u}=t.$$;i&&i.m(n,a),c||k((()=>{const n=s.map(e).filter(r);l?l.push(...n):o(n),t.$$.on_mount=[]})),u.forEach(k)}(a,c.target,c.anchor,c.customElement),E()}var w,v;p(m)}const N=async()=>{console.log("Registering service worker...");try{const t=await navigator.serviceWorker.register("sw.js",{scope:"./"});console.info("Registered service worker on "+t.scope)}catch(t){console.warn("Failed to register service worker: ",t)}},P=async()=>{if(navigator.serviceWorker&&!navigator.serviceWorker.controller){const t=new Promise((t=>navigator.serviceWorker.addEventListener("controllerchange",t,{once:!0}))),e=function(t,e){let n=-1;const o=new Promise(((o,r)=>{n=self.setTimeout((()=>r(e)),t)}));return{promise:o,cancel:()=>self.clearTimeout(n)}}(4e3,"SW ready timeout");await Promise.race([t,e.promise]),e.cancel()}},F=t=>{navigator.serviceWorker.controller.postMessage(t)},O=async()=>{const t=await(async()=>await window.showDirectoryPicker())();return await P(),F({type:"host-start"}),t},T=async(t,e)=>{e&&!e.endsWith("/")&&(e+="/");let n=`<!DOCTYPE html>\n\t<html><head>\n\t<meta charset="utf-8">\n\t<title>Directory listing for ${e||"/"}</title>\n\t</head><body>\n\t<h1>Directory listing for ${e||"/"}</h1><ul>`;for await(const[e,o]of t.entries()){const t="directory"===o.kind?"/":"";n+=`<li><a href="${e}${t}">${e}${t}</a></li>`}return n+="</ul></body></html>",new Blob([n],{type:"text/html"})};function j(e){let n,o,r,a,h,p,g,m,$,y,w,v,b,k,x,_,E,W,D,C,L,N=e[0]?.name+"";return{c(){n=s("main"),o=s("p"),o.textContent="Version: 0.0.3",r=u(),a=s("button"),a.textContent="Load Folder",h=u(),p=s("div"),g=l("folderName: "),m=l(N),$=u(),y=s("div"),w=l("clientID: "),v=l(e[3]),b=u(),k=s("div"),x=s("a"),_=l(e[2]),E=l(e[1]),W=l("/"),d(x,"href",D=e[2]+e[1]+"/"),d(x,"class","svelte-f579x2")},m(t,i){var s,l,u,d;!function(t,e,n){t.insertBefore(e,n||null)}(t,n,i),c(n,o),c(n,r),c(n,a),c(n,h),c(n,p),c(p,g),c(p,m),c(n,$),c(n,y),c(y,w),c(y,v),c(n,b),c(n,k),c(k,x),c(x,_),c(x,E),c(x,W),C||(s=a,l="click",u=e[4],s.addEventListener(l,u,d),L=()=>s.removeEventListener(l,u,d),C=!0)},p(t,[e]){1&e&&N!==(N=t[0]?.name+"")&&f(m,N),8&e&&f(v,t[3]),4&e&&f(_,t[2]),2&e&&f(E,t[1]),6&e&&D!==(D=t[2]+t[1]+"/")&&d(x,"href",D)},i:t,o:t,d(t){t&&i(n),C=!1,L()}}}function A(t,e,n){g((async()=>{await N()}));let o=null;window.addEventListener("unload",(()=>{F({type:"host-stop",hostName:r})})),navigator.serviceWorker.addEventListener("message",(t=>{switch(t.data.type){case"start-ok":e=t.data,n(1,r=e.hostName),n(2,a=e.scope),n(3,c=e.clientId);break;case"fetch":(async(t,e)=>{try{let n=decodeURIComponent(e.data.url);n.endsWith("/")&&(n=n.substr(0,n.length-1));const o=n.indexOf("?");-1!==o&&(n=n.substr(0,o));const r=n.split("/");let a=t;for(let t=0,e=r.length-1;t<e;++t){const e=r[t];a=await a.getDirectoryHandle(e)}let c=null;const i=r[r.length-1];if(i)try{const t=await a.getDirectoryHandle(i);c=await T(t,n)}catch{const t=await a.getFileHandle(i);c=await t.getFile()}else c=await T(a,n);e.data.port.postMessage({type:"ok",file:c})}catch(t){console.error(`Unable to serve file '${e.data.url}': `,t),e.data.port.postMessage({type:"not-found"})}})(o,t);break;default:console.warn(`Unknown message from SW '${t.data.type}'`)}var e}));let r="",a=null,c="";return[o,r,a,c,async()=>{n(0,o=await O())}]}return new class extends class{$destroy(){!function(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}{constructor(t){super(),L(this,t,A,j,a,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
